\documentclass[11pt]{report}

% Dependencies
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{multicol}
\usepackage{amssymb}
\usepackage{tabularx}
\usepackage{xcolor}
\usepackage{fancyhdr}
\usepackage{fontspec}
\usepackage{titlesec, blindtext}
\usepackage[spanish,es-tabla]{babel}
\usepackage{tocloft}
\usepackage[
    hyperindex=true,
    bookmarks=true,
    bookmarksnumbered=true,
    hidelinks,
]{hyperref}
\usepackage[all]{hypcap}
\usepackage{caption}
\usepackage{float}
\usepackage{bytefield}
\usepackage{listings}
\usepackage{listings-rust}
\usepackage{bibentry}
\lstset{
  basicstyle=\ttfamily\footnotesize,
  columns=fullflexible,
  numbers=left,
  frame=single,
  breaklines=true,
  postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Document style                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[
    lmargin=3cm,
    rmargin=3cm,
    tmargin=2.5cm,
    bmargin=2.5cm,
]{geometry}
\setmainfont{Arial}
\definecolor{greyed}{RGB}{242,242,242}

\fancypagestyle{plain}{
    \setlength{\headheight}{18.18pt}
    \fancyhf{}
    \fancyhead[L]{
        \color{gray}
        \scriptsize
        Desarrollo de una herramienta de análisis de tráfico de red y su uso en algoritmos de ML para la detección de ataques.
        \\
        Raul Rabadan Arroyo
    }
    %\renewcommand{\headrulewidth}{0pt}
    \fancyfoot[R]{\thepage}
}
\pagestyle{plain}

\fancypagestyle{nonumber}{
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
}

\titleformat{\chapter}[hang]{\huge\bfseries}{\theHchapter.~}{0pt}{\huge\bfseries}
\titlespacing*{\chapter}{0pt}{0pt}{12pt}

\renewcommand{\baselinestretch}{1.5} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Table of contents style                                                     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tocloftpagestyle{empty}

% Table of contents title
\setlength{\cftbeforetoctitleskip}{0ex}%
\setlength{\cftaftertoctitleskip}{0ex}%
\renewcommand{\cfttoctitlefont}{\hfill\textbf}%
\renewcommand{\cftaftertoctitle}{\hfill}%
\addto\captionsspanish{\renewcommand{\contentsname}{ÍNDICE}}

% Table of contents chapter
\setlength{\cftbeforechapskip}{1em}%
\setlength{\cftchapindent}{0em}%
\renewcommand{\cftchapaftersnum}{. \space}%
\renewcommand{\cftchapleader}{\hfill}%

% Table of contents section
\setlength{\cftbeforesecskip}{0.5em}%
\setlength{\cftsecindent}{0em}%
\renewcommand{\cftsecfont}{\bfseries\footnotesize}%
\renewcommand{\cftsecpagefont}{\bfseries\footnotesize}%
\renewcommand{\cftsecaftersnum}{. \space}%
\renewcommand{\cftsecleader}{\hfill}%

% Table of contents subsection
\setlength{\cftbeforesubsecskip}{0.5em}%
\setlength{\cftsubsecindent}{0em}%
\renewcommand{\cftsubsecfont}{\bfseries\footnotesize}%
\renewcommand{\cftsubsecpagefont}{\bfseries\footnotesize}%
\renewcommand{\cftsubsecaftersnum}{. \space}%
\renewcommand{\cftsubsecleader}{\hfill}%

% Table of contents subsubsection
\setlength{\cftbeforesubsubsecskip}{0.5em}%
\setlength{\cftsubsubsecindent}{0em}%
\renewcommand{\cftsubsubsecfont}{\bfseries\footnotesize}%
\renewcommand{\cftsubsubsecpagefont}{\bfseries\footnotesize}%
\renewcommand{\cftsubsubsecaftersnum}{. \space}%
\renewcommand{\cftsubsubsecleader}{\hfill}%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Document                                                                    %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

% Make default compilation not complain about missing bib
\nocite{*}
\bibliographystyle{unsrt}
\nobibliography{refsapp1}

\selectlanguage{spanish}

% Front page
\begin{titlepage}
    \includegraphics{media/epsevg_logo.jpeg}
    \begin{center}

        \vspace{1.5cm}
        {\Huge\textbf{TRABAJO FINAL DE GRADO}}

        \vfill
        {\Large\textbf{ANEXO 2: CÓDIGO FUENTE HERRAMIENTA}}

        \vfill

        \setlength\fboxsep{0.5cm}\fbox{
            \parbox{13.5cm}{
                \par{
                    \textbf{TÍTULO:} \MakeUppercase[]{Desarrollo de una herramienta de análisis de tráfico de red y su uso en algoritmos de ML para la detección de ataques.}
                    \\[\baselineskip]
                    \textbf{AUTOR:} RABADAN ARROYO, RAUL
                    \\[\baselineskip]
                    \textbf{FECHA DE PRESENTACIÓN:} JULIO, 2024
                }
            }
        }

        \vfill

    \end{center}
\end{titlepage}

% Index
\tableofcontents
\newpage

\chapter{Código fuente general}

\section{main.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/main.rs}

\section{lib.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/lib.rs}

\section{ground\_truth.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/ground_truth.rs}

\section{packet\_capture.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/packet_capture.rs}

\section{packet\_parse.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/packet_parse.rs}

\section{packet\_flow.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/packet_flow.rs}

\chapter{Código fuente estadísticas}

\section{mod.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/mod.rs}

\section{activity.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/activity.rs}

\section{byte\_count.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/byte_count.rs}

\section{flow\_stat.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/flow_stat.rs}

\section{flow\_statistics.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/flow_statistics.rs}

\section{flow\_times.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/flow_times.rs}

\section{interarrival.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/interarrival.rs}

\section{packet\_count.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/packet_count.rs}

\section{protocols.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/protocols.rs}

\section{running\_stat.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/running_stat.rs}

\section{tcp\_flags.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/tcp_flags.rs}

\section{transport.rs}
\lstinputlisting[language=Rust]{../packet_pincer/src/stats/transport.rs}

\chapter{Configuración de proyecto y dependencias}

\section{.gitignore}
\lstinputlisting[]{../packet_pincer/.gitignore}

\section{Cargo.toml}
\lstinputlisting[]{../packet_pincer/Cargo.toml}


\end{document}
