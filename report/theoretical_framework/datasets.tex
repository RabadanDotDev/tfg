\section{Datasets disponibles}

En esta sección analizaremos cuatro datasets disponibles utilizados para aplicaciones de ciberseguridad basadas en inteligencia artificial. Concretamente, observaremos CIC-DDos\-2019 \cite{8888419}, BoT-IoT \cite{DBLP:journals/corr/abs-1811-00701} \cite{10.1007/978-3-319-90775-8_3} \cite{KORONIOTIS202091} \cite{DBLP:journals/corr/abs-2005-00722} \cite{9252856} \cite{phdbotiot}, TON-IoT \cite{MOUSTAFA2021102994} \cite{9444348} \cite{9189760} \cite{9343133} \cite{9343084} \cite{moustafa2019systemic} \cite{ASHRAF2021103041} y UNSW-NB15 \cite{7348942} \cite{doi:10.1080/19393555.2015.1125974} \cite{7948715} \cite{Moustafa2017} \cite{10.1007/978-3-030-72802-1_9}.

\subsection{CICDDos2019}

\subsubsection{Descripción}

CICDDos2019 es un dataset creado por el Canadian Institute for Cybersecurity que contiene trazas de dos días en los que aparece tráfico benigno y serie de ataques DDoS típicos. \cite{cicddos2019web}. En este se contienen trazas de red en formato pcap y csvs con estadísticas de los flujos generados a partir de CICFlowMeter y posteriormente etiquetados. Para poder ofrecer un dataset público, realista y, además de mantener la privacidad de las comunicaciones originales, se generó tráfico sintético modelado a partir del comportamiento real de los usuarios. En las referencias se menciona el sistema utilizado para generar el comportamiento lo más natural posible de 25 usuarios haciendo uso de HTTP, HTTPS, FTP, SSH y protocolos de correo.

Los elementos de la red interna consisten en:

\begin{enumerate}
    \item Servidor web con Ubuntu 16.04 (192.168.50.1 en el primer día, 192.168.50.4 en el segundo día)
    \item Firewall con Fortinet (205.174.165.81)
    \item PC con Windows 7 (192.168.50.8 en el primer día, 192.168.50.9 en el segundo día)
    \item PC con Windows Vista (192.168.50.5 en el primer día, 192.168.50.6 en el segundo día)
    \item PC con Windows 8.1 (192.168.50.6 en el primer día, 192.168.50.7 en el segundo día)
    \item PC con Windows 10 (192.168.50.7 en el primer día, 192.168.50.8 en el segundo día)
\end{enumerate}

Adicionalmente, se han generado ataques DDoS basados en reflejos (usar un sistema de terceros para amplificar un ataque) y DDoS basado en exploits (tomar ventaja de vulnerabilidades en los protocolos). Según la información disponible \cite{cicddos2019web}, estos consisten en:

\begin{enumerate}
    \item \textbf{MSSQL}: Generado el primer día de 10:53 a 10:42 y el segundo de 11:36 a 11:45
    \item \textbf{SSDP}: Generado el segundo día de 12:27 a 12:37
    \item \textbf{DNS}: Generado el segundo día de 10:52 a 11:05
    \item \textbf{LDAP}: Generado el primer día de 10:21 a 10:30 y el segundo de 11:22 a 11:32
    \item \textbf{NetBIOS}: Generado el primer día de 10:00 a 10:09 y el segundo de 11:50 a 12:00
    \item \textbf{SNMP}: Generado el segundo día de 12:12 a 12:23
    \item \textbf{PortMap}: Generado el primer día de 9:43 a 9:51
    \item \textbf{WebDDoS}: Generado el segundo día de 13:18 a 13:29
    \item \textbf{NTP}: Generado el segundo día de 10:35 a 10:45
    \item \textbf{TFTP}: Generado el segundo día de 13:35 a 17:15
    \item \textbf{SYN Flood}: Generado el primer día de 11:28 a 17:35 y segundo día de 13:29 a 13:34
    \item \textbf{UDP Flood}: Generado el primer día de 10:53 a 11:03 y segundo día de 12:45 a 13:09
    \item \textbf{UDP-Lag}: Generado el primer día de 11:14 a 11:24 y segundo día de 13:11 a 13:15
\end{enumerate}

\subsubsection{Contenidos csvs}

El conjunto de datos procesados utilizando CICFlowMeter y etiquetado está compuesto por una lista de archivos por cada uno de los dos días en los que se generaron datos, el 3 de noviembre de 2018 y el 1 de diciembre de 2018. Las características ofrecidas son las mismas que las mencionadas en la herramienta CICFlowMeter. En todas las filas existen valores con excepción de algunas en la columna "Flow Bytes/s". Los scripts utilizados para la extracción y representación de los datos son \texttt{extract\_info\_cicddos\_2019.py} y \texttt{plot\_info\_cicddos\_2019.py} disponibles en TODO DEFINIR.

Como podemos ver en las figuras \ref{fig:cicddos_2019_csv_03-11_file_results} y \ref{fig:cicddos_2019_csv_01-12_file_results}, los archivos no contienen únicamente ataques etiquetados con su mismo nombre y benignos, sino que algunos contienen entre uno y dos adicionales. Para el primero, las categorías adicionales provienen de otros archivos. Para el segundo, la categoría adicional en UDPLag.csv no tiene ningún archivo específico y su magnitud es de las más bajas. A pesar de esto, si miramos las líneas temporales respectivas en las figuras \ref{fig:cicddos_2019_csv_03-11_timeline} y \ref{fig:cicddos_2019_csv_01-12_timeline}, podemos ver que el único caso donde existen solapamientos es en el caso de WebDDoS y UDP-Lag.

\begin{figure}[!htb]
    \minipage{0.49\textwidth}
      \includegraphics[width=\linewidth]{media/cicddos_2019_csv_03-11_file_results.png}
      \captionsetup{justification=centering}
      \caption{Número de flujos por archivo de las trazas de noviembre 3}\label{fig:cicddos_2019_csv_03-11_file_results}
    \endminipage\hfill
    \minipage{0.49\textwidth}
      \includegraphics[width=\linewidth]{media/cicddos_2019_csv_01-12_file_results.png}
      \captionsetup{justification=centering}
      \caption{Número de flujos por archivo de las trazas de diciembre 1}\label{fig:cicddos_2019_csv_01-12_file_results}
    \endminipage\hfill
\end{figure}

\begin{figure}[H]
    \begin{center}
        \includegraphics[width=1\linewidth]{media/cicddos_2019_csv_03-11_timeline.png}
    \end{center}
    \captionsetup{justification=centering}
    \caption{Línea temporal de las trazas de noviembre 3 con los archivos (debajo) y los rangos de ataques en estos (arriba)}\label{fig:cicddos_2019_csv_03-11_timeline}
\end{figure}
\begin{figure}[H]
    \begin{center}
        \includegraphics[width=1\linewidth]{media/cicddos_2019_csv_01-12_timeline.png}
    \end{center}
    \captionsetup{justification=centering}
    \caption{Línea temporal de las trazas de diciembre 1 con los archivos (debajo) y los rangos de ataques en estos (arriba)}\label{fig:cicddos_2019_csv_01-12_timeline}
\end{figure}

%\begin{figure}[!htb]
%    \minipage{1\textwidth}
%      \includegraphics[width=\linewidth]{media/cicddos_2019_csv_day_results.png}
%      \captionsetup{justification=centering}
%      \caption{Número de flujos por archivo de las trazas de noviembre 3}\label{fig:cicddos_2019_csv_day_results}
%    \endminipage
%\end{figure}

\subsubsection{Contenidos pcaps}

El dataset CICDDos2019 ofrece un conjunto de trazas de red de los dos días en los que se generaron datos. Para el primer día (3 de noviembre), hay 145 archivos de unos 190.7 MiB cada uno y un último de 66.5 MiB. Para el segundo día (1 de diciembre), se ofrecen 818 archivos de 190.7 MiB cada uno y uno adicional de 3.7 MiB. En ambos casos, si intentamos abrir el último paquete con Wireshark o generamos cualquier análisis a través de tshark, se nos notifica que el paquete se encuentra 'cortado'. Esto es quizá causado porque, en el momento de generar las trazas, se cortó el proceso de captura precipitadamente. Los scripts utilizados para la extracción de datos es \texttt{extract\_info\_cicddos\_2019\_pcaps\_tshark.sh} y el utilizado para la representacion de estos es \texttt{evaluate\_info\_cicddos\_2019\_pcaps\_tshark.py} disponibles en TODO DEFINIR.

En los pcap, aparecen más direcciones IP en la red del testbed (192.\-168.\-50.\-0/24) de las mencionadas en la información ofrecida en la web del dataset. Concretamente, tenemos que en el primer día aparecen adicionalmente 192.\-168.\-50.\-4, 192.\-168.\-50.\-9 192.\-168.\-50.\-253 y 192.\-168.\-50.\-254. En el segundo día, tenemos que aparecen 192.\-168.\-50.\-253 y 192.\-168.\-50.\-254 además del posible router con IP 192.\-168.\-50.\-1. Adicionalmente, en ambos casos aparece la IP de broadcast (192.\-168.\-50.\-255). Respecto al número de direcciones IP únicas, podemos ver que en el primer día aparecen 1321 y en el segundo 640, teniendo en total 1723 únicas en el transcurso de los dos días. 

Se han generado histogramas con la distribución de la duración de los flujos, número de tramas y número de bytes para poder compararlos con los futuros resultados de la herramienta y comprobar que son consistentes. Como podemos ver en la Figura \ref{fig:cicddos_2019_pcap_duration_distribution}, hay muchos flujos los cuales su duración es relativamente corta y luego hay cierta variedad de flujos de mayor duración. Para el caso de las tramas, podemos observar en la Figura \ref{fig:cicddos_2019_pcap_frames_distribution} que en su mayoría se concentran entre 1 y 1000 tramas y a continuación se reduce drásticamente la cantidad, aunque hay un grupo de flujos los cuales se comprenden entre 10 000 y 100 000. En la Figura \ref{fig:cicddos_2019_pcap_bytes_distribution}, podemos ver que tenemos un caso similar, la mayoría se concentra en las partes bajas, después decrece y hay un grupo numeroso separado el cual realiza una gran transferencia de datos.

\begin{figure}[H]
    \begin{center}
        \includegraphics[width=0.49\linewidth]{media/cicddos_2019_pcap_duration_distribution.png}
    \end{center}
    \captionsetup{justification=centering}
    \caption{Distribución duraciones de flujos en CICDDos2019}\label{fig:cicddos_2019_pcap_duration_distribution}
\end{figure}

\begin{figure}[H]
    \minipage{0.49\textwidth}
      \includegraphics[width=\linewidth]{media/cicddos_2019_pcap_frames_distribution.png}
      \captionsetup{justification=centering}
      \caption{Distribución número de tramas en flujos en CICDDos2019}\label{fig:cicddos_2019_pcap_frames_distribution}
    \endminipage\hfill
    \minipage{0.49\textwidth}
      \includegraphics[width=\linewidth]{media/cicddos_2019_pcap_bytes_distribution.png}
      \captionsetup{justification=centering}
      \caption{Distribución número de bytes en flujos en CICDDos2019}\label{fig:cicddos_2019_pcap_bytes_distribution}
    \endminipage\hfill
\end{figure}

\input{theoretical_framework/datasets_cicddos_protos.tex}

\subsection{BoT-IoT}

(por hacer)

\subsection{TON-IoT}

(por hacer)

\subsection{UNSW-NB15}

(por hacer)
